package parsers.common;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

import components.Utilities;
import models.MessageCA;
import models.PaletteBucket;

public class Val {

	public static List<MessageCA> Parse(InputStream val) throws IOException {
		// (0,0,0)=100
		ArrayList<MessageCA> messages = new ArrayList<MessageCA>();
		
		Utilities.ReadFile(val, (String l) -> {			
			if (l.isBlank()) return;

			if (!l.startsWith("[")) throw new RuntimeException("File format does not correspond to a type A palette.");
			
			String[] split = l.split(", | |,");

			int r = Integer.parseInt(split[1]);
			int g = Integer.parseInt(split[2]);
			int b = Integer.parseInt(split[3]);
			
			String[] bucket = split[0].substring(1, split[0].length() - 1).split(";");
			
			float start = Float.parseFloat(bucket[0]);
			float end = Float.parseFloat(bucket[1]);
						
			palette.add(new PaletteBucket(start, end, new int[] { r,g,b }));			
		});
		
		return palette;
	}
	
	/*
	 
	ParseValFile(file) {
		var data = [];

		// Each line looks like this: (y,x,z)=value
		file.trim().split(/\n/).forEach(function(line) {
			line = line.trim();
			
			if (line.length < 4) return; // probably empty line
			
			var cI = line.indexOf('('); // coordinate start
			var cJ = line.indexOf(')'); // coordinate end
			var vI = line.indexOf('='); // value start
			
			var c = line.substring(cI + 1, cJ).replace(/\s/g, "").split(",").map(d => +d);

			var value = parseFloat(line.substr(vI + 1));
			
			data.push(new TransitionCA("00:00:00:000", null, c, "out", value));
		}.bind(this));
		
		return data;
	}
	 
	 * */
}
